<!-- src/app/components/asignaturas/asignaturas.component.html -->
<div class="asignaturas-page">
  <!-- HEADER -->
  <div class="section-header mb-4">
    <h1 class="section-title">
      <i class="bi bi-book-fill me-3"></i>
      Gestión de Asignaturas
    </h1>
    <div class="section-controls d-flex gap-3 align-items-center">
      <input
        [formControl]="searchControl"
        class="form-control"
        placeholder="Buscar por nombre o código..."
        aria-label="Buscar asignaturas"
      >
    </div>
  </div>

  <!-- CONTENEDOR PARA ASYNC -->
  <ng-container *ngIf="filteredAsignaturas$ | async as asignaturas">
    <!-- LOADING -->
    <div *ngIf="isLoading" class="loading text-center my-5">
      <div class="spinner"></div>
      <p>Cargando asignaturas...</p>
    </div>

    <!-- SIN DATOS -->
    <div *ngIf="!isLoading && asignaturas.length === 0" class="empty text-center my-5">
      <i class="bi bi-inbox display-1 text-muted"></i>
      <p>No se encontraron asignaturas</p>
    </div>

    <!-- TABLA -->
    <div class="section-card" *ngIf="!isLoading && asignaturas.length > 0" data-aos="fade-up">
      <div class="section-body">
        <div class="table-responsive">
          <table class="asignaturas-table">
            <thead>
              <tr>
                <th><i class="bi bi-book me-2"></i>Nombre</th>
                <th><i class="bi bi-hash me-2"></i>Código</th>
                <th><i class="bi bi-file-text me-2"></i>Créditos</th>
                <th><i class="bi bi-person-fill me-2"></i>Profesores</th>
                <th><i class="bi bi-people-fill me-2"></i>Estudiantes</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let asignatura of asignaturas; let i = index"
                  [attr.data-aos]="'fade-up'" [attr.data-aos-delay]="i * 80">
                <td>{{ asignatura.nombre }}</td>
                <td>{{ asignatura.codigoAsignatura }}</td>
                <td>{{ asignatura.creditos }}</td>
                <td>
                  <ng-container *ngIf="asignatura.profesores?.length; else noProfesores">
                    <span class="badge bg-success me-1" *ngFor="let prof of asignatura.profesores">{{ prof }}</span>
                  </ng-container>
                  <ng-template #noProfesores>
                    <span class="text-muted">Sin profesores</span>
                  </ng-template>
                </td>
                <td>
                  <ng-container *ngIf="asignatura.estudiantes?.length; else noEstudiantes">
                    <span class="badge bg-info me-1" *ngFor="let est of asignatura.estudiantes">{{ est }}</span>
                  </ng-container>
                  <ng-template #noEstudiantes>
                    <span class="text-muted">Sin estudiantes</span>
                  </ng-template>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- PAGINACIÓN -->
      <div class="section-footer mt-4 d-flex justify-content-between align-items-center">
        <div class="pagination-info">
          Mostrando {{ (currentPage - 1) * pageSize + 1 }} -
          {{ (currentPage * pageSize) > asignaturas.length ? asignaturas.length : (currentPage * pageSize) }}
          de {{ asignaturas.length }} asignaturas
        </div>
        <nav aria-label="Paginación de asignaturas">
          <ul class="pagination">
            <li class="page-item" [class.disabled]="currentPage === 1">
              <button class="page-link" (click)="changePage(currentPage - 1)" aria-label="Página anterior">
                <i class="bi bi-chevron-left"></i>
              </button>
            </li>
            <li class="page-item" *ngFor="let page of pages"
                [class.active]="page === currentPage">
              <button class="page-link" (click)="changePage(page)">{{ page }}</button>
            </li>
            <li class="page-item" [class.disabled]="currentPage === totalPages">
              <button class="page-link" (click)="changePage(currentPage + 1)" aria-label="Página siguiente">
                <i class="bi bi-chevron-right"></i>
              </button>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </ng-container>
</div>
