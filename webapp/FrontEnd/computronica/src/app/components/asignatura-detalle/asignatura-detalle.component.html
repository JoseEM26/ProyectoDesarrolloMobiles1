<!-- src/app/components/asignatura-detalle/asignatura-detalle.component.html -->
<div class="container py-4">
  <!-- BOTÓN VOLVER -->
  <button class="btn btn-outline-secondary btn-sm mb-3" (click)="volver()">
    <i class="bi bi-arrow-left"></i> Volver a Asignaturas
  </button>

  <!-- DETALLE DE ASIGNATURA -->
  <div *ngIf="asignatura$ | async as asignatura; else loading">
    <div class="card border-0 shadow-sm rounded-3">
      <div class="card-body p-4">

        <!-- TÍTULO Y CÓDIGO -->
        <h2 class="h4 fw-bold text-primary mb-1">{{ asignatura.nombre }}</h2>
        <p class="text-muted small mb-3">
          {{ asignatura.codigoAsignatura }} • {{ asignatura.creditos }} crédito{{ asignatura.creditos === 1 ? '' : 's' }}
        </p>

        <!-- DESCRIPCIÓN -->
        <p class="text-muted small mb-4" *ngIf="asignatura.descripcion">
          {{ asignatura.descripcion }}
        </p>

        <!-- BOTÓN CREAR TEMA (SOLO ADMIN) -->
        <div class="mb-4" *ngIf="isAdmin">
          <button class="btn btn-success btn-sm d-flex align-items-center gap-2" (click)="openCreateTemaModal()">
            <i class="bi bi-plus-circle"></i>
            Agregar Tema
          </button>
        </div>

        <!-- PROFESORES -->
        <div class="mb-4">
          <h6 class="fw-semibold text-dark mb-2">
            <i class="bi bi-person-badge"></i> Profesores
          </h6>
          <div class="d-flex flex-wrap gap-2">
            <ng-container *ngIf="profesores$ | async as profesores; else noData">
              <span *ngFor="let p of profesores" class="badge bg-primary bg-opacity-10 text-primary px-3 py-2 rounded-pill">
                {{ p.nombre }} {{ p.apellido }}
              </span>
            </ng-container>
          </div>
        </div>

        <!-- ESTUDIANTES -->
        <div class="mb-4">
          <h6 class="fw-semibold text-dark mb-2">
            <i class="bi bi-people"></i> Estudiantes
          </h6>
          <div class="d-flex flex-wrap gap-2">
            <ng-container *ngIf="estudiantes$ | async as estudiantes; else noData">
              <span *ngFor="let e of estudiantes" class="badge bg-info bg-opacity-10 text-info px-3 py-2 rounded-pill">
                {{ e.nombre }} {{ e.apellido }}
              </span>
            </ng-container>
          </div>
        </div>

        <!-- TEMAS -->
        <div class="mt-5">
          <h5 class="fw-bold text-dark mb-3">
            <i class="bi bi-list-ul"></i> Temas
          </h5>

          <!-- LISTA DE TEMAS -->
          <div *ngIf="temas$ | async as temas; else noTemas">
            <div class="list-group">
              <div *ngFor="let tema of temas" class="list-group-item list-group-item-action p-4 rounded-3 mb-2 shadow-sm">
                <div class="d-flex w-100 justify-content-between align-items-start">
                  <div class="flex-grow-1">
                    <h6 class="mb-1 fw-semibold text-primary">{{ tema.nombre }}</h6>
                    <p class="mb-1 text-muted small" *ngIf="tema.descripcion">
                      {{ tema.descripcion }}
                    </p>
                    <small class="text-muted">
                      <i class="bi bi-calendar"></i> Creado el {{ tema.fechaCreacion | date:'short' }}
                    </small>
                  </div>

                  <!-- BOTONES EDITAR/ELIMINAR (SOLO ADMIN) -->
                  <div class="btn-group" *ngIf="isAdmin">
                    <button class="btn btn-outline-primary btn-sm" (click)="editarTema(tema)" title="Editar">
                      <i class="bi bi-pencil"></i>
                    </button>
                    <button class="btn btn-outline-danger btn-sm" (click)="eliminarTema(tema)" title="Eliminar">
                      <i class="bi bi-trash"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ESTADO: CARGANDO -->
  <ng-template #loading>
    <div class="text-center py-5">
      <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="mt-3 text-muted fs-5">Cargando asignatura...</p>
    </div>
  </ng-template>

  <!-- ESTADO: SIN DATOS -->
  <ng-template #noData>
    <span class="text-muted small">—</span>
  </ng-template>

  <!-- ESTADO: SIN TEMAS -->
  <ng-template #noTemas>
    <div class="text-center py-5 text-muted">
      <i class="bi bi-journal-x display-5 opacity-50"></i>
      <p class="mt-3 h6">No hay temas creados aún</p>
      <button *ngIf="isAdmin" class="btn btn-outline-primary mt-2" (click)="openCreateTemaModal()">
        <i class="bi bi-plus-circle"></i> Crear primer tema
      </button>
    </div>
  </ng-template>
</div>
